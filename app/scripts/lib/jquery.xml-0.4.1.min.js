(function(a,g,f){a.fn.xml=function(c){var d=a.Deferred(),b=a(this);if(!a.xml._settings()){var e={xml:"/xml/template.xml",async:!1,tagName:"template",error:function(a){console.error(a)}};c&&a.extend(e,c);null===e.target&&console.error("no target given");!1==e.async?a.when(a.xml.loadXml(e.xml)).then(function(c){a.xml._settings({target:b,$xmlDoc:c,settings:e});d.resolve()}):(a.xml._settings({target:b,settings:e}),d.resolve())}return d.promise()};a.xml={_settings:function(c){if(c)a(f).data("jquery.xml",
c);else return a(f).data("jquery.xml")},append:function(c,d){c||(c="home");var b=a.xml._settings();$el=b.target;$xmlDoc=b.$xmlDoc;tagName=b.settings.tagName;!0===b.settings.async?a.when(a.xml.loadXml(b.settings.xml)).then(function(e){a.xml._append_xml(e,b,c,d)}):a.xml._append_xml($xmlDoc,b,c,d)},_append_xml:function(c,d,b,e){c=c.find(tagName+"#"+b).first();if(0==c.length&&(b=a.Event("error",{type:404}),!d.settings.error.apply(d.target,[b])))return;if(b=c.attr("access"))if(b=a.Event("error",{type:403,
access:b}),!d.settings.error.apply(d.target,[b]))return;d=c.clone().contents();d=a("<div/>").append(d);d.find("br").replaceWith("<br/>");$el.append(d.html());e&&e.apply($el)},loadXml:function(c){var d=a.Deferred();a.ajax({url:c,type:"GET",dataType:"text",success:function(b){b=a.parseXML(b);d.resolve(a(b))},error:function(a){console.error(a.responseText)}});$xmlDoc=a(null);return d.promise()}}})(jQuery,window,document);
